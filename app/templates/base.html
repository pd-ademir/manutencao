<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>{% block titulo %}Manuten√ß√£o{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">

</head>
<body class="pagina-base">

  {% if current_user.is_authenticated %}
  <!-- MENU SUPERIOR -->
  <header class="navbar">
    <div class="navbar-logo">
      <img src="{{ url_for('static', filename='logo.jpg') }}" alt="Logo">
      <span class="sistema-titulo">Gest√£o de Manuten√ß√£o  </span>
    </div>
    <nav class="navbar-menu">
      <ul>
        <li><a href="{{ url_for('main.index') }}">In√≠cio</a></li>

        {% if current_user.tipo == 'master' %}
          <li><a href="{{ url_for('main.gerenciar_usuarios') }}">Usu√°rios</a></li>
          <li><a href="{{ url_for('main.exibir_logs') }}">Logs</a></li>
        {% endif %}

        <!-- UNIDADES -->
        <li class="dropdown">
        <a href="#" class="dropdown-toggle" onclick="toggleDropdown('unidades-menu'); return false;">Unidades ‚ñæ</a>
        <ul class="dropdown-menu" id="unidades-menu">

            <li><a href="{{ url_for('main.lista_placas') }}">Todas as Placas</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='BAGAM') }}">BAGAM</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='BACRO') }}">BACRO</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='SPOT RN') }}">SPOT RN</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='SPOT PE') }}">SPOT PE</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='SMART') }}">SMART</a></li>
          </ul>
        </li>

        <!-- A√á√ïES -->
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" onclick="toggleDropdown('acoes-menu'); return false;">A√ß√µes ‚ñæ</a>
          <ul class="dropdown-menu dropdown" id="acoes-menu">
            <li><a href="{{ url_for('main.realizar_manutencao') }}">Nova Manuten√ß√£o</a></li>
            <li><a href="{{ url_for('main.cadastro_veiculo') }}">Cadastrar Ve√≠culo</a></li>
            <li><a href="{{ url_for('main.lista_placas') }}">üìã Ve√≠culos Cadastrados</a></li>
          </ul>
        </li>

        <!-- SAIR -->
        <li style="margin-left:auto;"><a href="{{ url_for('main.logout') }}">Sair</a></li>
      </ul>
    </nav>
  </header>

  <!-- BOAS-VINDAS -->
  <div class="boas-vindas">
    üëã Bem-vindo, <strong>{{ current_user.nome }}</strong>! Que bom ter voc√™ de volta.
  </div>
  {% endif %}

  <!-- CONTE√öDO -->
  <div class="conteudo">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% for categoria, msg in messages %}
        <div class="mensagem {{ categoria }}">{{ msg }}</div>
      {% endfor %}
    {% endwith %}
    {% block conteudo %}{% endblock %}
  </div>

  <!-- RODAP√â -->
  <div class="rodape">
    Desenvolvido por 64Bits Inform√°tica &copy; {{ ano if ano else "2025" }}
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
  });

  function toggleDropdown(id) {
    const menu = document.getElementById(id);
    const isOpen = menu.classList.contains('open');
    document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
    if (!isOpen) menu.classList.add('open');
  }

  document.addEventListener('click', function (e) {
    if (!e.target.closest('.dropdown')) {
      document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    console.log('P√°gina carregada. Removendo dropdowns...');
    document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
  });
</script>



</body>
</html>
