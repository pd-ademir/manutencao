<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>{% block titulo %}ManutenÃ§Ã£o{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">
</head>
<body class="pagina-base">

  {% if current_user.is_authenticated %}
  <!-- MENU SUPERIOR -->
  <header class="navbar">
    <div class="navbar-logo">
      <img src="{{ url_for('static', filename='logo.jpg') }}" alt="Logo">
      <span class="sistema-titulo">GestÃ£o de ManutenÃ§Ã£o</span>
    </div>
    <nav class="navbar-menu">
      <ul>
        <li><a href="{{ url_for('main.index') }}">InÃ­cio</a></li>

        {% if current_user.tipo == 'master' %}
          <li><a href="{{ url_for('main.gerenciar_usuarios') }}">UsuÃ¡rios</a></li>
          <li><a href="{{ url_for('main.exibir_logs') }}">Logs</a></li>
        {% endif %}

        <!-- UNIDADES -->
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" onclick="toggleDropdown('unidades-menu'); return false;">Unidades â–¾</a>
          <ul class="dropdown-menu" id="unidades-menu">
            <li><a href="{{ url_for('main.lista_placas') }}">Todas as Placas</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='BAGAM') }}">BAGAM</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='BACRO') }}">BACRO</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='SPOT RN') }}">SPOT RN</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='SPOT PE') }}">SPOT PE</a></li>
            <li><a href="{{ url_for('main.filtrar_unidade', unidade='SMART') }}">SMART</a></li>
          </ul>
        </li>

        <!-- AÃ‡Ã•ES -->
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" onclick="toggleDropdown('acoes-menu'); return false;">AÃ§Ãµes â–¾</a>
          <ul class="dropdown-menu dropdown" id="acoes-menu">
            <li><a href="{{ url_for('main.realizar_manutencao') }}">Nova ManutenÃ§Ã£o</a></li>
            <li><a href="{{ url_for('main.cadastro_veiculo') }}">Cadastrar VeÃ­culo</a></li>
            <li><a href="{{ url_for('main.lista_placas') }}">ðŸ“‹ VeÃ­culos Cadastrados</a></li>
          </ul>
        </li>

        <!-- PNEUS -->
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" onclick="toggleDropdown('pneus-menu'); return false;">ðŸ›ž Pneus â–¾</a>
          <ul class="dropdown-menu dropdown" id="pneus-menu">
            <li><a href="{{ url_for('main.cadastrar_estoque') }}">âž• Cadastrar Pneu</a></li>
            <li><a href="{{ url_for('main.mostrar_pneus') }}">ðŸ“¤ Aplicar Pneu</a></li>
            <li><a href="{{ url_for('main.visualizar_estoque') }}">ðŸ“¦ Visualizar Estoque</a></li>
          </ul>
        </li>

        <!-- SAIR -->
        <li style="margin-left:auto;"><a href="{{ url_for('main.logout') }}">Sair</a></li>
      </ul>
    </nav>
  </header>

  <!-- BOAS-VINDAS -->
  <div class="boas-vindas">
    ðŸ‘‹ Bem-vindo, <strong>{{ current_user.nome }}</strong>! Que bom ter vocÃª de volta.
  </div>
  {% endif %}

  <!-- CONTEÃšDO -->
  <div class="conteudo">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% for categoria, msg in messages %}
        <div class="mensagem {{ categoria }}">{{ msg }}</div>
      {% endfor %}
    {% endwith %}
    {% block conteudo %}{% endblock %}
  </div>

  <!-- RODAPÃ‰ -->
  <div class="rodape">
    Desenvolvido por 64Bits InformÃ¡tica &copy; {{ ano if ano else "2025" }}
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
    });

    function toggleDropdown(id) {
      const menu = document.getElementById(id);
      const isOpen = menu.classList.contains('open');
      document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
      if (!isOpen) menu.classList.add('open');
    }

    document.addEventListener('click', function (e) {
      if (!e.target.closest('.dropdown')) {
        document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
      }
    });
  </script>
</body>
</html>
